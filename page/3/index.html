<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="姜蜀黍的记事本">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="姜蜀黍的记事本">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="姜蜀黍的记事本">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"remove","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>姜蜀黍的记事本</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">姜蜀黍的记事本</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa  fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa  fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/10/10/JavaScript详细教程（1） - 表达式和运算符/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/10/JavaScript详细教程（1） - 表达式和运算符/" itemprop="url">JavaScript详细教程（1） - 表达式和运算符</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-10T22:14:00+08:00">
                2016-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,217
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="原始表达式"><a href="#原始表达式" class="headerlink" title="原始表达式"></a>原始表达式</h1><h2 id="直接量"><a href="#直接量" class="headerlink" title="直接量"></a>直接量</h2><p>直接量是直接在程序中出现的常数值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"hello"</span></div></pre></td></tr></table></figure></p>
<h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><p>JavaScript的一些保留字构成了原始表达式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="literal">true</span> </div><div class="line"><span class="literal">false</span></div><div class="line"><span class="literal">null</span></div><div class="line"><span class="keyword">this</span></div></pre></td></tr></table></figure></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/10/10/JavaScript详细教程（1） - 表达式和运算符/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/16/cas（Central Authentication Service）详细教程（3） - cas协议详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/16/cas（Central Authentication Service）详细教程（3） - cas协议详解/" itemprop="url">cas（Central Authentication Service）详细教程（3） - cas协议详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-16T17:32:00+08:00">
                2016-02-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cas/" itemprop="url" rel="index">
                    <span itemprop="name">cas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,779
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>CAS协议是一个简单且十分强大的基于票据管理的CAS专用协议，协议详细文档请移步<a href="http://jasig.github.io/cas/4.1.x/protocol/CAS-Protocol-Specification.html">http://jasig.github.io/cas/4.1.x/protocol/CAS-Protocol-Specification.html</a><br>该协议中涉及到一个或多个CAS客户端和服务端的交互，客户端嵌入了CAS的类库，而CAS服务端则是一个独立的应用程序。CAS服务端负责用户的认证和授予访问权限给访问请求。CAS客户端负责保护应用程序和接收CAS服务端对用户的认证数据。交互过程主要涉及到概念有：</p>
<ul>
<li>TGT（Ticket Granting Ticket），存储在名为CASTGC的cookie中，代表一个用户的单点登录session</li>
<li>ST（Service Ticket）,作为Http的GET请求的一个参数在URL中传递，代表了CAS针对某个特定用户授予了准予访问的权限</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/02/16/cas（Central Authentication Service）详细教程（3） - cas协议详解/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/15/cas（Central Authentication Service）详细教程（2） - cas结构详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/15/cas（Central Authentication Service）详细教程（2） - cas结构详解/" itemprop="url">cas（Central Authentication Service）详细教程（2） - cas结构详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-15T14:16:00+08:00">
                2016-02-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cas/" itemprop="url" rel="index">
                    <span itemprop="name">cas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  764
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>CAS的认证过程就是通过执行以下几个相互关联的组件组成</p>
<blockquote>
<ul>
<li>PrincipalNameTransformer<br>将输入到登录表单的用户标识字符串转换成一个临时的主体名称，然后该主体名称将被指定的Authentication Handler进行验证</li>
<li>AuthenticationManager<br>AuthenticationManager作为认证子系统的一个入口，其可以接收一个或多个凭据，并调用配置文件中指定的AuthenticationHandler组件对接收到的凭证进行验证。其存储着每次进行验证的结果和确定有效的安全策略</li>
<li>AuthenticationHandler<br>验证单个凭据并返回认证后的三种可能的结果：成功，失败，未尝试</li>
<li>PrincipalResolver<br>将认证凭据中的信息转换成一个安全的主体，通常主题中包含一些额外的元数据属性（例如：用户的细节信息如：隶属关系，组关系，邮件，昵称）</li>
<li>AuthenticationMetaDataPopulator<br>针对认证成功事件设置任意任意元数据的策略组件，该组件通常用于设置特定协议的数据</li>
</ul>
</blockquote>
<p>针对以上组件若未作特殊声明，均在deployerConfigContext.xml中配置</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/02/15/cas（Central Authentication Service）详细教程（2） - cas结构详解/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/13/cas（Central Authentication Service）详细教程（1） - 概述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/13/cas（Central Authentication Service）详细教程（1） - 概述/" itemprop="url">cas（Central Authentication Service）详细教程（1） - 概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-13T14:16:00+08:00">
                2016-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cas/" itemprop="url" rel="index">
                    <span itemprop="name">cas</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  828
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>cas（Central Authentication Service）即集中式认证服务,是一种针对互联网的单点登录协议。</p>
<p>它的目的是允许一个用户访问多个应用程序，而只需提供一次凭证（如用户名和密码）。它还允许web应用程序在没有获得用户的安全凭据（如密码）的情况下对用户进行身份验证，从总体架构上来看CAS包含服务端和客户端两个独立的组件，他们之间通过各种协议进行通信。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2016/02/13/cas（Central Authentication Service）详细教程（1） - 概述/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/01/NodeJS知识点（1） - 异步IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/01/NodeJS知识点（1） - 异步IO/" itemprop="url">NodeJS学习笔记（1） - 异步IO</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-08-01T19:31:00+08:00">
                2015-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,614
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="阻塞、非阻塞I-O"><a href="#阻塞、非阻塞I-O" class="headerlink" title="阻塞、非阻塞I/O"></a>阻塞、非阻塞I/O</h2><p>操作系统内核对于I/O只有两种方式：阻塞与阻塞<br>阻塞I/O的一个特点是调用之后一定要等到系统内核层面完成所有操作后，调用才会结束；以读取磁盘上的一段文件为例，系统内核在完成磁盘寻道，读取数据，复制数据到内存中之后这个调用才会结束。阻塞I/O造成CPU等待I/O,浪费等待时间，CPU的处理能力不能得到充分利用为了提供性能。为此内核提供了非阻塞。非阻塞I/O和阻塞I/O的区别为调用后立即返回。</p>
<p>操作系统对计算机进行了抽象，将所有输入输出的设备抽象为文件。内核在进行文件I/O操作时，通过文件描述符进行管理，而文件描述符类似于应用程序与系统内核之间的凭证，应用程序如果需要进行I/O调用，需要先打开文件描述符，然后再根据文件描述符去实现文件的数据读写。从这个角度来讲阻塞I/O非阻塞I/O的区别在于阻塞I/O需要完成整个获取数据的过程。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2015/08/01/NodeJS知识点（1） - 异步IO/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/04/15/spring MVC知识点总结（3） - 注解式控制器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/04/15/spring MVC知识点总结（3） - 注解式控制器/" itemprop="url">spring MVC知识点总结（2） - 注解式控制器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-15T18:17:00+08:00">
                2015-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  2,236
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="注解式控制器-请求映射规则"><a href="#注解式控制器-请求映射规则" class="headerlink" title="注解式控制器 - 请求映射规则"></a>注解式控制器 - 请求映射规则</h2><p>URL路径限定</p>
<p>普通URL路径映射</p>
<p>@RequestMapping(value={“/test1”, “/user/create”})：多个URL路径可以映射到同一个处理器的功能处理方法。</p>
<p>URI模板模式映射</p>
<p>@RequestMapping(value=”/users/{userId}”)：{×××}占位符， 请求的URL可以是 “/users/123456”或”/users/abcd”，通过@PathVariable可以提取URI模板模式中的{×××}中的×××变量</p>
<p>Ant风格的URL路径映射</p>
<p>@RequestMapping(value=”/product?”)：可匹配”/product1”或”/producta”，但不匹配”/product”或”/productaa”;</p>
<p>正则表达式风格的URL路径映射</p>
<p>从Spring3.0开始支持正则表达式风格的URL路径映射，格式为{变量名:正则表达式}，这样我们就可以通过6.6.5讲的通过@PathVariable提取模式中的{×××：正则表达式匹配的值}中的×××变量了</p>
<p>组合使用URL路径限定，是”或”的关系</p>
<p>如 @RequestMapping(value={“/test1”, “/user/create”})<br>组合使用是或的关系，即”/test1”或”/user/create”请求URL路径都可以映射到@RequestMapping指定的功能处理方法</p>
<h2 id="请求方法映射限定"><a href="#请求方法映射限定" class="headerlink" title="请求方法映射限定"></a>请求方法映射限定</h2><p>//处理器的通用映射前缀<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span>  </div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/customers/**"</span>)                                     </div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMethodController</span> </span>&#123;  </div><div class="line">    <span class="comment">//对类级别的@RequestMapping窄化，表示showForm可处理匹配"/customers/**/create"且请求方法为"GET"的请求；</span></div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/create"</span>, method = RequestMethod.GET) </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"===============GET"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"customer/create"</span>;    </div><div class="line">    &#125;</div><div class="line">    <span class="comment">//对类级别的@RequestMapping进行窄化，表示submit可处理匹配"/customers/**/create"且请求方法为"POST"的请求。</span></div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/create"</span>, method = RequestMethod.POST)<span class="comment">//③类级别的@RequestMapping窄化  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">submit</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"================POST"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;          </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>组合使用请求方法映射限定是”或”的关系</p>
<p>@RequestMapping(value=”/methodOr”, method = {RequestMethod.POST, RequestMethod.GET})：即请求方法可以是 GET 或 POST。</p>
<p>提示</p>
<p>1、一般浏览器只支持GET、POST请求方法，<br>2、除了GET、POST，还有HEAD、OPTIONS、PUT、DELETE、TRACE。<br>3、DispatcherServlet默认开启对 GET、POST、PUT、DELETE、HEAD的支持；<br>4、如果需要支持OPTIONS、TRACE，请添加DispatcherServlet在web.xml的初始化参数：dispatchOptionsRequest 和 dispatchTraceRequest 为true。</p>
<p>请求参数数据映射限定<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.javass.chapter6.web.controller.method;  </div><div class="line"><span class="meta">@Controller</span>  </div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/customers/**"</span>)                                     <span class="comment">//①处理器的通用映射前缀  </span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMethodController</span> </span>&#123;  </div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/create"</span>, method = RequestMethod.GET)<span class="comment">//②类级别的@RequestMapping窄化  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"===============GET"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"customer/create"</span>;    </div><div class="line">    &#125;  </div><div class="line">    <span class="meta">@RequestMapping</span>(value=<span class="string">"/create"</span>, method = RequestMethod.POST)<span class="comment">//③类级别的@RequestMapping窄化  </span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">submit</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"================POST"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;          </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>请求参数数据映射限定<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> cn.javass.chapter6.web.controller.parameter;  </div><div class="line"><span class="comment">//省略import  </span></div><div class="line"><span class="meta">@Controller</span>  </div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/parameter1"</span>)                                      <span class="comment">//①处理器的通用映射前缀  </span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestParameterController1</span> </span>&#123;  </div><div class="line">    <span class="comment">//表示请求中有"create"的参数名且请求方法为"GET"即可匹配，如可匹配的请求URL"http://×××/parameter1?create"</span></div><div class="line">    <span class="meta">@RequestMapping</span>(params=<span class="string">"create"</span>, method=RequestMethod.GET)   </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"===============showForm"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"parameter/create"</span>;          </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//表示请求中有"create"的参数名且请求方法为"POST"即可匹配 </span></div><div class="line">    <span class="meta">@RequestMapping</span>(params=<span class="string">"create"</span>, method=RequestMethod.POST)    </div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">submit</span><span class="params">()</span> </span>&#123;  </div><div class="line">        System.out.println(<span class="string">"================submit"</span>);  </div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/success"</span>;          </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>请求参数中指定参数名 = 值</p>
<p>@RequestMapping(params=”create”, method=RequestMethod.GET)<br>表示请求中有”create”的参数名且请求方法为”GET”即可匹配，如可匹配的请求URL”<a href="http://×××/parameter1?create“" target="_blank" rel="external">http://×××/parameter1?create“</a></p>
<p>请求参数中指定参数名 != 值</p>
<p>@RequestMapping(params=”submitFlag!=create”, method=RequestMethod.GET)<br>表示请求中的参数”submitFlag!=create”且请求方法为”GET”即可匹配，如可匹配的请求URL”<a href="http://×××/parameter1?submitFlag=abc“" target="_blank" rel="external">http://×××/parameter1?submitFlag=abc“</a></p>
<p>组合使用请求参数名，是”且”的关系</p>
<p>@RequestMapping(params={“test1”, “test2=create”})<br>表示请求中的有”test1”参数名 且 有”test2=create”参数即可匹配，如可匹配的请求URL”<a href="http://×××/parameter3?test1&amp;test2=create&quot;。" target="_blank" rel="external">http://×××/parameter3?test1&amp;test2=create&quot;。</a></p>
<p>请求头数据映射限定</p>
<p>请求头数据中有指定参数名</p>
<p>@RequestMapping(value=”/header/test1”, headers = “Accept”)<br>表示请求的URL必须为”/header/test1”且请求头中必须有Accept参数才能匹配。</p>
<p>请求头数据中没有指定参数名</p>
<p>@RequestMapping(value=”/header/test2”, headers = “!abc”)<br>表示请求的URL必须为”/header/test2”且请求头中必须没有abc参数才能匹配。（将Modify Header的abc参数值删除即可）</p>
<p>请求头数据中指定参数名 = 值</p>
<p>@RequestMapping(value=”/header/test3”, headers = “Content-Type=application/json”)<br>表示请求的URL必须为”/header/test3” 且 请求头中必须有”Content-Type=application/json”参数即可匹配。（将Modify Header的Content-Type参数值改为”application/json”即可）</p>
<p>请求头数据中指定参数名 != 值</p>
<p>@RequestMapping(value=”/header/test7”, headers = “Accept!=text/vnd.wap.wml”)<br>表示请求的URL必须为”/header/test7” 且 请求头中必须有”Accept”参数但值不等于”text/vnd.wap.wml”即可匹配</p>
<p>组合使用请求头数据：是”且”的关系</p>
<p>@RequestMapping(value=”/header/test8”, headers = {“Accept!=text/vnd.wap.wml”,”abc=123”})<br>表示请求的URL必须为”/header/test8” 且 请求头中必须有”Accept”参数但值不等于”text/vnd.wap.wml”且 请求中必须有参数”abc=123”即可匹配</p>
<h2 id="注解式控制器-生产者消费者限定"><a href="#注解式控制器-生产者消费者限定" class="headerlink" title="注解式控制器 - 生产者消费者限定"></a>注解式控制器 - 生产者消费者限定</h2><p>基本概念</p>
<p>Media Type</p>
<p>互联网媒体类型，一般就是我们所说的MIME类型，用来确定请求的内容类型或响应的内容类型</p>
<p>常见Media Type:</p>
<p>text/html ： HTML格式          text/plain ：纯文本格式             text/xml ：XML格式<br>image/gif ：gif图片格式          image/jpeg ：jpg图片格式          image/png：png图片格式</p>
<p>application/x-www-form-urlencoded ： <form enctype="">中默认的encType，form表单数据被编码为key/value格式发送到服务器（表单默认的提交数据的格式）。<br>multipart/form-data ： 当你需要在表单中进行文件上传时，就需要使用该格式；</form></p>
<p>application/xhtml+xml ：XHTML格式               application/xml     ： XML数据格式<br>application/atom+xml  ：Atom XML聚合格式    application/json    ： JSON数据格式<br>application/pdf       ：pdf格式                        application/msword  ： Word文档格式<br>application/octet-stream ： 二进制流数据（如常见的文件下载）。<br>Content-Type</p>
<p>内容类型，即请求/响应的内容区数据的媒体类型</p>
<p>请求头的内容类型，表示发送到服务器的内容数据的媒体类型<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/ContentType"</span>, method = RequestMethod.GET)  </div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">showForm</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;  </div><div class="line">    <span class="comment">//form表单，使用application/x-www-form-urlencoded编码方式提交表单  </span></div><div class="line">    <span class="keyword">return</span> <span class="string">"consumesproduces/Content-Type"</span>;  </div><div class="line">&#125;  </div><div class="line"></div><div class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/ContentType"</span>, method = RequestMethod.POST, headers = <span class="string">"Content-Type=application/x-www-form-urlencoded"</span>)  </div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">request1</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> IOException </span>&#123;  </div><div class="line">    <span class="comment">//1. 得到请求的内容区数据的类型  </span></div><div class="line">    String contentType = request.getContentType();   </div><div class="line">    System.out.println(<span class="string">"========ContentType:"</span> + contentType);  </div><div class="line">    <span class="comment">//2. 得到请求的内容区数据的编码方式，如果请求中没有指定则为null  </span></div><div class="line">    <span class="comment">//注意，我们的CharacterEncodingFilter这个过滤器设置了编码(UTF-8)  </span></div><div class="line">    <span class="comment">//编码只能被指定一次，即如果客户端设置了编码，则过滤器不会再设置  </span></div><div class="line">    String characterEncoding = request.getCharacterEncoding();  </div><div class="line">    System.out.println(<span class="string">"========CharacterEncoding:"</span> + characterEncoding);  </div><div class="line"></div><div class="line">    <span class="comment">//3. 表示请求的内容区数据为form表单提交的参数，此时我们可以通过request.getParameter得到数据（key=value）  </span></div><div class="line">    System.out.println(request.getParameter(<span class="string">"realname"</span>));  </div><div class="line">    System.out.println(request.getParameter(<span class="string">"username"</span>));  </div><div class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>request中设置请求头”Content-Type: application/x-www-form-urlencoded”表示请求的数据为key/value数据</p>
<p>request功能处理方法：只对请求头为”Content-Type:application/x-www-form-urlencoded”的请求进行处理（即消费请求内容区数据）</p>
<p>request.getContentType()：可以得到请求头的内容区数据类型（即Content-Type头的值）<br>request.getCharacterEncoding()：如”Content-Type:application/json;charset=GBK”,则得到的编码为”GBK”，否则如果你设置过滤器（CharacterEncodingFilter）则得到它设置的编码，否则返回null。<br>request.getParameter()：因为请求的内容区数据为application/x-www-form-urlencoded格式的数据，因此我们可以通过request.getParameter()得到相应参数数据。<br>响应头的内容类型，表示发送到客户端的内容数据类型，和请求头的内容类型类似，只是方向相反</p>
<h2 id="生产者、消费者限定"><a href="#生产者、消费者限定" class="headerlink" title="生产者、消费者限定"></a>生产者、消费者限定</h2><ol>
<li>功能处理方法是消费者</li>
</ol>
<p>@RequestMapping(value = “/consumes”, consumes = {“application/json”})<br>此处使用consumes来指定功能处理方法能消费的媒体类型，其通过请求头的”Content-Type”来判断</p>
<p>此种方式相对使用@RequestMapping的headers = “Content-Type=application/json”更能表明你的目的</p>
<ol>
<li>功能处理方法是生产者</li>
</ol>
<p>@RequestMapping(value = “/produces”, produces = “application/json”)<br>表示将功能处理方法将生产json格式的数据，此时根据请求头中的Accept进行匹配，如请求头”Accept:application/json”时即可匹配</p>
<p>此种方式相对使用@RequestMapping的headers = “Accept=application/json”更能表明你的目的</p>
<ol>
<li>窄化时是覆盖 而 非继承</li>
</ol>
<p>如类级别的映射为 @RequestMapping(value=”/narrow”, produces=”text/html”)，方法级别的为@RequestMapping(produces=”application/xml”)，此时方法级别的映射将覆盖类级别的，因此请求头“Accept:application/xml”是成功的，而“text/html”将报406错误码，表示不支持的请求媒体类型</p>
<ol>
<li>组合使用生产者、消费者限定是”或”的关系</li>
</ol>
<p>@RequestMapping(produces={“text/html”, “application/json”}) ：将匹配“Accept:text/html”或“Accept:application/json”</p>
<ol>
<li>问题</li>
</ol>
<p>消费的数据，如JSON数据、XML数据都是由我们读取请求的InputStream并根据需要自己转换为相应的模型数据，比较麻烦；</p>
<p>生产的数据，如JSON数据、XML数据都是由我们自己先把模型数据转换为json/xml等数据，然后输出响应流，也是比较麻烦的。</p>
<p>Spring提供了一组注解（@RequestBody、@ResponseBody）和一组转换类（HttpMessageConverter）来完成我们遇到的问题</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/04/12/spring MVC知识点总结（2） - 拦截器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/04/12/spring MVC知识点总结（2） - 拦截器/" itemprop="url">spring MVC知识点总结（2） - 拦截器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-12T18:17:00+08:00">
                2015-04-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,129
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="DispatcherServlet作用"><a href="#DispatcherServlet作用" class="headerlink" title="DispatcherServlet作用"></a>DispatcherServlet作用</h2><p>常见应用场景<br>日志记录：记录请求信息的日志，以便进行信息监控、信息统计、计算PV（Page View）等。</p>
<p>权限检查：如登录检测，进入处理器检测检测是否登录，如果没有直接返回到登录页面；</p>
<p>性能监控：有时候系统在某段时间莫名其妙的慢，可以通过拦截器在进入处理器之前记录开始时间，在处理完后记录结束时间，从而得到该请求的处理时间（如果有反向代理，如apache可以自动记录）；</p>
<p>通用行为：读取cookie得到用户信息并将用户对象放入请求，从而方便后续流程使用，还有如提取Locale、Theme信息等，只要是多个处理器都需要的即可使用拦截器实现。</p>
<p>OpenSessionInView：如Hibernate，在进入处理器打开Session，在完成后关闭Session。</p>
<p>本质也是AOP（面向切面编程），也就是说符合横切关注点的所有功能都可以放入拦截器实现</p>
<h2 id="拦截器接口"><a href="#拦截器接口" class="headerlink" title="拦截器接口"></a>拦截器接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.springframework.web.servlet;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HandlerInterceptor</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(</span></span></div><div class="line">            HttpServletRequest request, HttpServletResponse response, </div><div class="line">            Object handler) </div><div class="line">            <span class="keyword">throws</span> Exception;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(</span></span></div><div class="line">            HttpServletRequest request, HttpServletResponse response, </div><div class="line">            Object handler, ModelAndView modelAndView) </div><div class="line">            <span class="keyword">throws</span> Exception;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(</span></span></div><div class="line">            HttpServletRequest request, HttpServletResponse response, </div><div class="line">            Object handler, Exception ex)</div><div class="line">            <span class="keyword">throws</span> Exception;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>preHandle预处理回调方法，实现处理器的预处理（如登录检查），第三个参数为响应的处理器（如我们上一章的Controller实现）；</p>
<p>返回值：true表示继续流程（如调用下一个拦截器或处理器）；</p>
<p>false表示流程中断（如登录检查失败），不会继续调用其他的拦截器或处理器，此时我们需要通过response来产生响应；</p>
<p>postHandle后处理回调方法，实现处理器的后处理（但在渲染视图之前），此时我们可以通过modelAndView（模型和视图对象）对模型数据进行处理或对视图进行处理，modelAndView也可能为null。</p>
<p>afterCompletion整个请求处理完毕回调方法，即在视图渲染完毕时回调，如性能监控中我们可以在此记录结束时间并输出消耗时间，还可以进行一些资源清理，类似于try-catch-finally中的finally，但仅调用处理器执行链中preHandle返回true的拦截器的afterCompletion。</p>
<h2 id="拦截器适配器"><a href="#拦截器适配器" class="headerlink" title="拦截器适配器"></a>拦截器适配器</h2><p>有时候我们可能只需要实现三个回调方法中的某一个，如果实现HandlerInterceptor接口的话，三个方法必须实现，不管你需不需要，此时spring提供了一个HandlerInterceptorAdapter适配器（一种适配器设计模式的实现），允许我们只实现需要的回调方法</p>
<p>public abstract class HandlerInterceptorAdapter implements HandlerInterceptor {<br>     //省略代码 此处所以三个回调方法都是空实现，preHandle返回true。<br>}<br>spring MVC拦截器1.JPG</p>
<p>图1：正常流程</p>
<p>spring MVC拦截器2.JPG</p>
<p>图2：中断流程</p>
<p>注意：中断流程中，比如是HandlerInterceptor2中断的流程（preHandle返回false），此处仅调用它之前拦截器的preHandle返回true的afterCompletion方法。</p>
<p>应用<br>需求：</p>
<p>记录每个请求的处理时间，得到一些慢请求（如处理时间超过500毫秒），从而进行性能改进</p>
<p>实现方案：</p>
<p>在进入处理器之前记录开始时间，即在拦截器的preHandle记录开始时间；<br>在结束请求处理之后记录结束时间，即在拦截器的afterCompletion记录结束实现，并用结束时间-开始时间得到这次请求的处理时间。<br>问题：</p>
<p>拦截器是单例，因此不管用户请求多少次都只有一个拦截器实现，即线程不安全</p>
<p>解决方案是使用ThreadLocal，它是线程绑定的变量，提供线程局部变量（一个线程一个ThreadLocal，A线程的ThreadLocal只能看到A线程的ThreadLocal，不能看到B线程的ThreadLocal）</p>
<p>代码</p>
<pre><code class="java"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopWatchHandlerInterceptor</span> <span class="keyword">extends</span> <span class="title">HandlerInterceptorAdapter</span> </span>{  
    <span class="keyword">private</span> NamedThreadLocal&lt;Long&gt;  startTimeThreadLocal = <span class="keyword">new</span> NamedThreadLocal&lt;Long&gt;(<span class="string">"StopWatch-StartTime"</span>);  
    <span class="meta">@Override</span>  
    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response,   
Object handler)</span> <span class="keyword">throws</span> Exception </span>{  
        <span class="keyword">long</span> beginTime = System.currentTimeMillis();<span class="comment">//1、开始时间  </span>
        startTimeThreadLocal.set(beginTime);<span class="comment">//线程绑定变量（该数据只有当前请求的线程可见）  </span>
        <span class="keyword">return</span> <span class="keyword">true</span>;<span class="comment">//继续流程  </span>
    }  

    <span class="meta">@Override</span>  
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response,   
Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>{  
        <span class="keyword">long</span> endTime = System.currentTimeMillis();<span class="comment">//2、结束时间  </span>
        <span class="keyword">long</span> beginTime = startTimeThreadLocal.get();<span class="comment">//得到线程绑定的局部变量（开始时间）  </span>
        <span class="keyword">long</span> consumeTime = endTime - beginTime;<span class="comment">//3、消耗的时间  </span>
        <span class="keyword">if</span>(consumeTime &gt; <span class="number">500</span>) {<span class="comment">//此处认为处理时间超过500毫秒的请求为慢请求  </span>
            <span class="comment">//TODO 记录到日志文件  </span>
            System.out.println(  
String.format(<span class="string">"%s consume %d millis"</span>, request.getRequestURI(), consumeTime));  
        }          
    }  
}
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/04/07/spring MVC知识点总结（1） - DispatcherServlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jiangCluster">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="姜蜀黍的记事本">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/04/07/spring MVC知识点总结（1） - DispatcherServlet/" itemprop="url">spring MVC知识点总结（1） - DispatcherServlet</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-07T18:17:00+08:00">
                2015-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                  <span class="post-meta-divider">|</span>
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1,538
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="DispatcherServlet作用"><a href="#DispatcherServlet作用" class="headerlink" title="DispatcherServlet作用"></a>DispatcherServlet作用</h2><p>文件上传解析，如果请求类型是multipart将通过MultipartResolver进行文件上传解析；</p>
<p>通过HandlerMapping，将请求映射到处理器（返回一个HandlerExecutionChain，它包括一个处理器、多个HandlerInterceptor拦截器）；</p>
<p>通过HandlerAdapter支持多种类型的处理器(HandlerExecutionChain中的处理器)；</p>
<p>通过ViewResolver解析逻辑视图名到具体视图实现；</p>
<p>本地化解析；</p>
<p>渲染具体的视图等；</p>
<p>如果执行过程中遇到异常将交给HandlerExceptionResolver来解析。</p>
<p>DispatcherServlet中使用的Bean<br>DispatcherServlet默认使用WebApplicationContext作为上下文，因此我们来看一下该上下文中有哪些特殊的Bean：</p>
<p>Controller：处理器/页面控制器，做的是MVC中的C的事情，但控制逻辑转移到前端控制器了，用于对请求进行处理；</p>
<p>HandlerMapping：请求到处理器的映射，如果映射成功返回一个HandlerExecutionChain对象（包含一个Handler处理器（页面控制器）对象、多个HandlerInterceptor拦截器）对象；如BeanNameUrlHandlerMapping将URL与Bean名字映射，映射成功的Bean就是此处的处理器；</p>
<p>HandlerAdapter：HandlerAdapter将会把处理器包装为适配器，从而支持多种类型的处理器，即适配器设计模式的应用，从而很容易支持很多类型的处理器；如SimpleControllerHandlerAdapter将对实现了Controller接口的Bean进行适配，并且掉处理器的handleRequest方法进行功能处理；</p>
<p>ViewResolver：ViewResolver将把逻辑视图名解析为具体的View，通过这种策略模式，很容易更换其他视图技术；如InternalResourceViewResolver将逻辑视图名映射为jsp视图；</p>
<p>LocalResover：本地化解析，因为Spring支持国际化，因此LocalResover解析客户端的Locale信息从而方便进行国际化；</p>
<p>ThemeResovler：主题解析，通过它来实现一个页面多套风格，即常见的类似于软件皮肤效果；</p>
<p>MultipartResolver：文件上传解析，用于支持文件上传；</p>
<p>HandlerExceptionResolver：处理器异常解析，可以将异常映射到相应的统一错误界面，从而显示用户友好的界面（而不是给用户看到具体的错误信息）；</p>
<p>RequestToViewNameTranslator：当处理器没有返回逻辑视图名等相关信息时，自动将请求URL映射为逻辑视图名；</p>
<p>FlashMapManager：用于管理FlashMap的策略接口，FlashMap用于存储一个请求的输出，当进入另一个请求时作为该请求的输入，通常用于重定向场景，后边会细述。</p>
<h2 id="客户端缓存控制"><a href="#客户端缓存控制" class="headerlink" title="客户端缓存控制"></a>客户端缓存控制</h2><p>Http协议缓存控制</p>
<p>HTTP1.0缓存控制响应头<br>Pragma：no-cache：表示防止客户端缓存，需要强制从服务器获取最新的数据；<br>Expires：HTTP1.0响应头，本地副本缓存过期时间，如果客户端发现缓存文件没有过期则不发送请求，HTTP的日期时间必须是格林威治时间（GMT）， 如”Expires:Wed, 14 Mar 2012 09:38:32 GMT”；</p>
<p>HTTP1.1缓存控制响应头<br>Cache-Control ：no-cache 强制客户端每次请求获取服务器的最新版本，不经过本地缓存的副本验证；<br>Cache-Control ：no-store 强制客户端不保存请求的副本，该设置是防止Firefox缓存<br>Cache-Control：max-age=[秒] 客户端副本缓存的最长时间，类似于HTTP1.0的Expires，只是此处是基于请求的相对时间间隔来计算，而非绝对时间。</p>
<h2 id="Spring缓存控制"><a href="#Spring缓存控制" class="headerlink" title="Spring缓存控制"></a>Spring缓存控制</h2><p>cacheSeconds</p>
<p>cacheSeconds=5， 缓存5秒</p>
<p>cacheSeconds=0，不缓存</p>
<p>acheSeconds&lt;0，将不添加任何数据，响应头什么缓存控制信息也不加。</p>
<p>http请求头与springcacheSeconds配置关系</p>
<p>cacheSeconds = 0 时，则将设置如下响应头数据：<br>//HTTP 1.0的不缓存响应头<br>Pragma：no-cache<br>// useExpiresHeader=true时，HTTP 1.0<br>Expires：1L<br>//useCacheControlHeader=true时，HTTP 1.1<br>Cache-Control ：no-cache<br>// useCacheControlNoStore=true时，该设置是防止Firefox缓存<br>Cache-Control ：no-store</p>
<p>cacheSeconds &gt; 0 时，则将设置如下响应头数据：<br>// useCacheControlHeader=true时，HTTP 1.1<br>Expires：System.currentTimeMillis() + cacheSeconds * 1000L<br>// useExpiresHeader=true时，HTTP 1.0<br>Cache-Control ：max-age=cacheSeconds</p>
<p>cacheSeconds &lt; 0 时，则什么都不设置，即保留上次的缓存设置。</p>
<p>Last-Modified</p>
<p>在客户端第一次输入url时，服务器端会返回内容和状态码200表示请求成功并返回了内容；同时会添加一个”Last-Modified”的响应头表示此文件在服务器上的最后更新时间：如”Last-Modified:Wed, 14 Mar 2012 10:22:42 GMT”表示最后更新时间为（2012-03-14 10：22）；</p>
<p>客户端第二次请求此URL时，客户端会向服务器发送请求头 “If-Modified-Since”，询问服务器该时间之后当前请求内容是否有被修改过，如”If-Modified-Since: Wed, 14 Mar 2012 10:22:42 GMT”，如果服务器端的内容没有变化，则自动返回 HTTP 304状态码（只要响应头，内容为空，这样就节省了网络带宽）。</p>
<p>ETag（实体标记）</p>
<p>浏览器第一次请求，服务器在响应时给请求URL标记，并在HTTP响应头中将其传送到客户端，类似服务器端返回的格式：”ETag:”0f8b0c86fe2c0c7a67791e53d660208e3””</p>
<p>浏览器第二次请求，客户端的查询更新格式是这样的：”If-None-Match:”0f8b0c86fe2c0c7a67791e53d660208e3””，如果ETag没改变，表示内容没有发生改变，则返回状态304。</p>
<h2 id="客户端强制缓存过期"><a href="#客户端强制缓存过期" class="headerlink" title="客户端强制缓存过期"></a>客户端强制缓存过期</h2><p>可以按ctrl+F5强制刷新（会添加请求头 HTTP1.0 Pragma:no-cache和 HTTP1.1 Cache-Control:no-cache、If-Modified-Since请求头被删除）表示强制获取服务器内容，不缓存。</p>
<p>在请求的url后边加上时间戳来重新获取内容，加上时间戳后浏览器就认为不是同一份内容：ttp://sishuok.com/?2343243243 和 <a href="http://sishuok.com/?34334344" target="_blank" rel="external">http://sishuok.com/?34334344</a> 是两次不同的请</p>
<h2 id="缓存控制特殊情况"><a href="#缓存控制特殊情况" class="headerlink" title="缓存控制特殊情况"></a>缓存控制特殊情况</h2><p>对于一般的页面跳转（如超链接点击跳转、通过js调用window.open打开新页面都是会使用浏览器缓存的，在未过期情况下会直接使用浏览器缓存的副本，在未过期情况下一次请求也不发送）；</p>
<p>对于刷新页面（如按F5键刷新），会再次发送一次请求到服务器的；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          


          

        </div>
        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jiangCluster</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
